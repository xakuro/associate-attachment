var AssociateAttachmentTool;(function(t){AssociateAttachmentTool=function(a){let s=this,e=a.post_ids.length,n=0,o=0,c=0,i=!1;this.sprintf=function(){let a,s=t.makeArray(arguments),e=s.shift();for(a in s)e=e.replace("%s",s[a]);return e},this.updateStatus=function(a){n+=a.count,o+=a.count-a.error_count,c+=a.error_count,t("#associate-attachment-bar").progressbar("value",n/e*100),t("#associate-attachment-bar-percent").html(Math.round(n/e*100)+"%"),t("#associate-attachment-success-count").html(o),t("#associate-attachment-error-count").html(c);for(let s of a.messages)t("#associate-attachment-msg").append("<li>"+s+"</li>")},this.finalization=function(){let s,e=t("#message");t("#associate-attachment-stop-bottun").hide(),t("#associate-attachment-message").hide(),t("#associate-attachment-back-link").show(),i?(s=a.about_message,e.addClass("notice-success")):0===a.post_ids.length?(s=0===c?a.success_message:this.sprintf(a.failure_message,c),e.addClass("notice-success")):(s=a.error_message,e.addClass("notice-warning")),e.html("<p><strong>"+s+"</strong></p>"),e.show()},this.init=function(s){t("#associate-attachment-bar").progressbar(),t("#associate-attachment-bar-percent").html("0%"),t("#associate-attachment-stop-bottun").on("click",function(s){i=!0,t("#associate-attachment-stop-bottun").prop("disabled",!0),t("#associate-attachment-stop-bottun").val(a.stop_button_message)})},this.start=function(e){t.ajax({type:"POST",url:ajaxurl,data:{action:"associate_attachment",nonce:a.nonce,ids:e,enable_acf:a.enable_acf,enable_scf:a.enable_scf,enable_shortcode:a.enable_shortcode}}).done(function(t){t!==Object(t)&&(t=new Object,t.count=0),s.updateStatus(t),a.post_ids.length&&!i&&t.count===e.length?s.start(a.post_ids.splice(0,a.count_per_step)):s.finalization()})},this.init(),this.start(a.post_ids.splice(0,a.count_per_step))}})(jQuery);